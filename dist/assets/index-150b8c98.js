import{F as a,r as u,j as t,T as I,B as x,I as l,q as m,i as p,m as k}from"./index-7f3064dd.js";import{u as _}from"./useQuery-3eb598f2.js";import{u as b}from"./useMutation-a97383b0.js";import{r as S,s as T,t as q}from"./actions-c21add60.js";import{D as v,T as w}from"./index-3cb1c3aa.js";const K=()=>{const[i]=a.useForm(),[y,c]=u.useState(!1),[o,d]=u.useState(null),{data:n,isPending:h}=_({queryKey:["statistics"],queryFn:q,refetchOnWindowFocus:!1}),j=b({mutationFn:e=>S(e)}),f=async e=>{j.mutate(e.id),m.invalidateQueries({queryKey:["statistics"]})},g=async e=>{const s=await T(o.id,e);m.invalidateQueries({queryKey:["statistics"]}),r(),console.log(s,"res")},r=()=>{c(!1),d(null),i.resetFields()},F=[{title:"Название",dataIndex:"title",key:"title",flex:1},{title:"Кол-во",dataIndex:"statistic",key:"statistic",flex:1,align:"center"},{title:"Дата создания",dataIndex:"create_data",key:"create_data",flex:1,align:"center"},{title:"Дейтсвия",dataIndex:"action",key:"action",flex:1,align:"center",render:(e,s)=>t.jsxs("div",{className:"d-flex align-center justify-center gap-x-1",children:[t.jsx(p,{title:"Изменить",placement:"top",children:t.jsx(k,{cursor:"pointer",size:20,color:"#252525",onClick:()=>{c(!0),d(s),i.setFieldValue("title",s.title),i.setFieldValue("title_ru",s.title_ru),i.setFieldValue("title_en",s.title_en),i.setFieldValue("statistic",s.statistic)}})}),t.jsx(p,{title:"Удалить",placement:"top",children:t.jsx(w,{cursor:"pointer",size:20,color:"#252525",onClick:()=>f(s)})})]})}];return t.jsxs("main",{className:"statistics",children:[t.jsx("h1",{children:"Statistics"}),t.jsx("div",{className:"history-table m-t-2",children:t.jsx(I,{loading:h,column:F,row:n==null?void 0:n.map(e=>({...e,key:e.id}))})}),t.jsx(v,{history:{record:o,open:y,closeDrawer:r,title:"Добавить",footer:t.jsxs("div",{className:"d-flex align-center gap-x-2",children:[t.jsx(x,{type:"primary",form:"history-form",htmlType:"submit",children:"Сохранить"}),t.jsx(x,{danger:!0,onClick:r,children:"Отмена"})]})},children:t.jsxs(a,{typeof:"form-data",onFinish:g,form:i,id:"history-form",layout:"vertical",children:[t.jsx(a.Item,{name:"title",label:"Название UZ",children:t.jsx(l,{type:"text"})}),t.jsx(a.Item,{name:"title_ru",label:"Название РУ",children:t.jsx(l,{type:"text"})}),t.jsx(a.Item,{name:"title_en",label:"Название EN",children:t.jsx(l,{type:"text"})}),t.jsx(a.Item,{name:"statistic",label:"Статистика",children:t.jsx(l,{type:"text"})})]})})]})};export{K as default};
